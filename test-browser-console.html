<!DOCTYPE html>
<html>
<head>
    <title>Voice Cloning Test</title>
</head>
<body>
    <h1>üé§ Voice Cloning Test</h1>
    <div id="test-results"></div>

    <script>
        // Test the voice cloning logic that was implemented
        console.log("üß™ Testing Voice Cloning Implementation\n");

        // Test 1: Auto-generated name uniqueness
        const testAutoGeneratedNames = () => {
            console.log("Test 1: Auto-generated Names");
            const names = [];

            // Simulate generating 5 names rapidly
            for (let i = 0; i < 5; i++) {
                const now = new Date();
                const timeStr = now.toLocaleTimeString('en-US', {
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
                const dateStr = now.toLocaleDateString();
                const ms = now.getMilliseconds().toString().padStart(3, '0');
                const randomSuffix = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
                const name = `My Voice ${dateStr} ${timeStr}.${ms}.${randomSuffix}`;
                names.push(name);

                // Advance time slightly
                now.setMilliseconds(now.getMilliseconds() + 1);
            }

            const uniqueNames = new Set(names);
            const isUnique = uniqueNames.size === names.length;

            console.log("Generated names:", names);
            console.log("All unique?", isUnique ? "‚úÖ YES" : "‚ùå NO");
            return isUnique;
        };

        // Test 2: Duplicate resolution
        const testDuplicateResolution = () => {
            console.log("\nTest 2: Duplicate Name Resolution");
            const baseName = "Test Voice";
            const existingNames = new Set(["test voice", "test voice (copy)", "test voice (2)"]);

            let finalName = baseName;
            let counter = 1;

            while (existingNames.has(finalName.toLowerCase())) {
                if (counter === 1) {
                    finalName = `${baseName} (copy)`;
                } else if (counter === 2) {
                    const uuid = Date.now().toString(36) + Math.random().toString(36).substr(2, 9);
                    finalName = `${baseName}-${uuid}`;
                } else {
                    finalName = `${baseName} (${counter})`;
                }
                counter++;

                if (counter > 100) {
                    const uuid = Date.now().toString(36) + Math.random().toString(36).substr(2, 9);
                    finalName = `${baseName}-${uuid}`;
                    break;
                }
            }

            console.log(`Base name: "${baseName}"`);
            console.log(`Existing names:`, Array.from(existingNames));
            console.log(`Final resolved name: "${finalName}"`);

            const isResolved = finalName !== baseName && !existingNames.has(finalName.toLowerCase());
            console.log("Resolved correctly?", isResolved ? "‚úÖ YES" : "‚ùå NO");
            return isResolved;
        };

        // Test 3: Edge cases
        const testEdgeCases = () => {
            console.log("\nTest 3: Edge Cases");

            // Test very long name
            const longName = "A".repeat(200);
            console.log(`Long name length: ${longName.length}`);

            // Test special characters
            const specialName = "My Voice!@#$%^&*()";
            console.log(`Special characters: "${specialName}"`);

            // Test case sensitivity
            const caseTest1 = "My Voice";
            const caseTest2 = "my voice";
            console.log(`Case insensitive check: "${caseTest1}" vs "${caseTest2}"`);
            console.log("Case handled?", caseTest1.toLowerCase() === caseTest2.toLowerCase() ? "‚úÖ" : "‚ùå");

            return true;
        };

        // Run all tests
        const results = document.getElementById('test-results');
        results.innerHTML = "<h2>Test Results:</h2>";

        const tests = [
            { name: "Auto-generated Names", test: testAutoGeneratedNames },
            { name: "Duplicate Resolution", test: testDuplicateResolution },
            { name: "Edge Cases", test: testEdgeCases }
        ];

        let allPassed = true;

        tests.forEach(({ name, test }) => {
            try {
                const passed = test();
                results.innerHTML += `<p><strong>${name}:</strong> ${passed ? '‚úÖ PASSED' : '‚ùå FAILED'}</p>`;
                if (!passed) allPassed = false;
            } catch (error) {
                console.error(`Error in ${name}:`, error);
                results.innerHTML += `<p><strong>${name}:</strong> ‚ùå ERROR: ${error.message}</p>`;
                allPassed = false;
            }
        });

        results.innerHTML += `<h3>${allPassed ? '‚úÖ All Tests Passed!' : '‚ùå Some Tests Failed'}</h3>`;
        results.innerHTML += `<p>Open the browser console for detailed logs.</p>`;

        // Test completion
        console.log("\n‚úÖ Testing Complete!");
        console.log("Please test the actual voice cloning feature at: http://localhost:3000/");
    </script>
</body>
</html>